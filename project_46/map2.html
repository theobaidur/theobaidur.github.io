<!DOCTYPE html><html>	<head>		<title>Cordes map application</title>				<meta charset="utf-8">		<meta name="description" content="Cordes map application">		<meta name="keywords" content="">		<meta name="viewport" content="width=device-width, initial-scale=1">		<link rel="stylesheet" type="text/css" href="css/mapstyle.css"/>	</head>	<body>		<div id="map"></div>		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>		<script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places&language=en&iwloc=near"></script>		<script src="js/infobox.js"></script>		<script>							var contacts = [					{name: 'Teju Ravilochan', pic: 'img/dummy1.png', description: "<a target='_blank' href='http://www.unreasonableinstitute.org/'>Unreasonable Institute</a><br/><br/><b>Mission:</b> To give entrepreneurs tackling the world's greatest challenges an unreasonable advantage.<br/><br/><div class='social-icons'><a target='_blank' href='https://twitter.com/tejuravi' class='tw'></a> <a target='_blank' href='https://www.linkedin.com/in/tejuravilochan' class='in'></a><a target='_blank' href='https://www.facebook.com/tejuravilochan' class='fb'></a></div>", year: '2011', country_region: 'United States', issue_area: 'A', latitude: 42.0176, longitude: -105.2797},										{name: 'Kate Hawk', pic: 'img/dummy2.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2011', country_region: 'Norway', issue_area: 'B', latitude: 68.2, longitude: 13.6},										{name: 'Charlie Gables', pic: 'img/dummy3.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2012', country_region: 'USA', issue_area: 'B', latitude: 27.1, longitude: -80.7},					{name: 'Don Jones', pic: 'img/dummy4.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2013', country_region: 'Hungary', issue_area: 'D', latitude: 47.2, longitude: 18.9},					{name: 'Wayne Horwitz', pic: 'img/dummy5.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2014', country_region: 'Australia', issue_area: 'E', latitude: -38.2, longitude: 146.1},					{name: 'Kyle Morton', pic: 'img/dummy1.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2011', country_region: 'South Africa', issue_area: 'A', latitude: -29.1, longitude: 23},					{name: 'Susan Hopper', pic: 'img/dummy2.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2013', country_region: 'USA', issue_area: 'D', latitude: 30, longitude: -105},					{name: 'Greg Hinrichs', pic: 'img/dummy4.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2013', country_region: 'Brazil', issue_area: 'A', latitude: -23.6, longitude: -46.6},					{name: 'David Hughes', pic: 'img/dummy1.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2014', country_region: 'Hongkong', issue_area: 'D', latitude: 22.6, longitude: 114.1},					{name: 'Gianluigi Pietro', pic: 'img/dummy5.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2012', country_region: 'Italy', issue_area: 'A', latitude: 41.9, longitude: 12.6},					{name: 'Abe Lincoln', pic: 'img/dummy4.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2011', country_region: 'UAE', issue_area: 'C', latitude: 25.283, longitude: 55.321},					{name: 'Pavel Kovalchuk', pic: 'img/dummy5.png', description: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting', year: '2012', country_region: 'Russia', issue_area: 'B', latitude: 55.754, longitude: 37.621}				];								var mapControls = (function ( jQ ) {									function dropdown(controloptions){						var dropdown = jQ('<div class="container"><div class="dropDownControl" id="dd_years">' + controloptions.name + '<img src="http://maps.gstatic.com/mapfiles/arrow-down.png" class="dropDownArrow"/></div></div>');						dropdown.append(dropdownOptionsDiv(controloptions.dropdown));						controloptions.map.controls[controloptions.position].push(dropdown.get(0));						google.maps.event.addDomListener(dropdown.children(":first").get(0),'click',function(){													(jQ("#" + controloptions.dropdown.id).is(":visible")) ? 														(function(){								jQ(".dropDownOptionsDiv").slideUp("fast");							})() 														: 														(function(){								jQ(".dropDownOptionsDiv").slideUp("fast");								jQ("#" + controloptions.dropdown.id).slideDown("fast");							})()													});											}										function dropdownOptionsDiv(divoptions){						var container = jQ('<div class="dropDownOptionsDiv" id="' + divoptions.id + '"></div>');												//divoptions.items.push();												for(i=0; i<divoptions.items.length; i++){							divoptions.items[i].appendTo(container);						}												return container;						}										function checkBox(cboptions){						var cbcontainer = jQ('<div class="checkboxContainer"><span role="checkbox" class="checkboxSpan"><div class="blankDiv" id="' + cboptions.tickid + '"><input type="checkbox" id="' + cboptions.id + '" class="' + cboptions.class + '"/><img src="http://maps.gstatic.com/mapfiles/mv/imgs8.png" class="blankImg"/></div></span><label class="checkboxLabel">' + cboptions.checkbox_label.toString() + '</label></div>');												google.maps.event.addDomListener(cbcontainer.get(0),'click',function(){							(jQ("#" + cboptions.tickid).is(":visible")) ? 														(function(){								//Hide the tick								jQ("#" + cboptions.tickid).hide();								//Set the checkbox to false								jQ("#" + cboptions.id).prop("checked", false);								//Trigger filter update								cboptions.callback();							})() 														: 														(function(){								//Show the tick								jQ("#" + cboptions.tickid).show();								//Set the checkbox to true								jQ("#" + cboptions.id).prop("checked", true);								//Trigger filter update								cboptions.callback();							})()						});												return cbcontainer;											}										function attribution(options){						var container = jQ('<img class="' + options.class + '" src="' + options.src + '" alt="' + options.alt + '"/>');						options.map.controls[options.position].push(container.get(0));					}										return{						createDropDown: function(opts){							dropdown(opts);						},						createCheckBox: function(opts){							return checkBox(opts);						},						createAttribution: function(opts){							attribution(opts);						}					};				}) ($);								var contactMap = (function ( jQ ) {										var map = null;					var infowindow = new google.maps.InfoWindow();					var infobox = new InfoBox();					var pins = [];					var mapstyle = [					  {						"featureType": "administrative",						"stylers": [						  { "visibility": "off" }						]					  },{						"featureType": "road",						"stylers": [						  { "visibility": "off" }						]					  },{						"featureType": "water",						"elementType": "labels",						"stylers": [						  { "visibility": "off" }						]					  },{						"featureType": "water",						"stylers": [						  { "color": "#383838" }						]					  },{						"featureType": "landscape",						"stylers": [						  { "color": "#191919" }						]					  },{						"featureType": "transit",						"stylers": [						  { "visibility": "off" }						]					  },{						"featureType": "poi",						"stylers": [						  { "visibility": "off" }						]					  },{						"featureType": "landscape.natural.terrain",						"stylers": [						  { "color": "#151515" }						]					  },{						"featureType": "water",						"stylers": [						  { "visibility": "simplified" },						  { "saturation": -100 },						  { "weight": 0.1 }						]					  }					];					var center = new google.maps.LatLng(40, 8);					var vertical = false;										function init(){						map = new google.maps.Map(document.getElementById("map"), {							center: center,							mapTypeId: google.maps.MapTypeId.ROADMAP,							zoom:2,							disableDefaultUI: true,							styles: mapstyle													});												mapEvents();						initControls();					}															function mapEvents(){						google.maps.event.addListener(map, "dragend", function(){							center = map.getCenter();						});						google.maps.event.addListener(map, "click", function(){							if(infobox.getVisible()){								infobox.close();							}						});											}				 					function initControls(){												var years = {text: [], checkboxes: []};						var countries = {text: [], checkboxes: []};						var areas = {text: [], checkboxes: []};												for(i=0;i<contacts.length;i++){							if(jQ.inArray(contacts[i]['year'], years["text"])<0){								years["text"].push(contacts[i]['year']);								years["checkboxes"].push(mapControls.createCheckBox({id: "cb_" + contacts[i]['year'], tickid: 'cb_' + contacts[i]['year'] + '_t', checkbox_label: contacts[i]['year'], class:"year", callback: contactMap.preFilterContacts}));							}							if(jQ.inArray(contacts[i]['country_region'], countries["text"])<0){								countries["text"].push(contacts[i]['country_region']);								countries["checkboxes"].push(mapControls.createCheckBox({id: "cb_h" + contacts[i]['country_region'].toLowerCase(), tickid: 'cb_' + contacts[i]['country_region'].toLowerCase() + '_t', checkbox_label: contacts[i]['country_region'], class:"country", callback: contactMap.preFilterContacts}));							}							if(jQ.inArray(contacts[i]['issue_area'], areas["text"])<0){								areas["text"].push(contacts[i]['issue_area']);								areas["checkboxes"].push(mapControls.createCheckBox({id: "cbia_" + contacts[i]['issue_area'].toLowerCase(), tickid: 'cbia_' + contacts[i]['issue_area'].toLowerCase() + '_t', checkbox_label: contacts[i]['issue_area'], class:"issuearea", callback: contactMap.preFilterContacts}));							}													}												mapControls.createDropDown({							map: map, 							name: "Year", 							id: "dd_year",							position: google.maps.ControlPosition.TOP_LEFT, 							dropdown: {								id: "dd_year_container", 								items: years["checkboxes"]							}						});												mapControls.createDropDown({							map: map, 							name: "Country", 							id: "dd_country", 							position: google.maps.ControlPosition.TOP_LEFT,							dropdown: {								id: "dd_country_container",								items: countries["checkboxes"]							}						});												mapControls.createDropDown({							map: map, 							name: "Issue Area",							id: "dd_issuearea", 							position: google.maps.ControlPosition.TOP_LEFT,							dropdown: {								id: "dd_issuearea_container",								items: areas["checkboxes"]							}						});												mapControls.createAttribution({'src': 'img/cordes_logo.png', 'alt': 'Cordes Logo', 'map': map, 'position': google.maps.ControlPosition.RIGHT_BOTTOM, 'class': 'attribution'});					}										function loaddata(data){						var bounds = new google.maps.LatLngBounds();						for(i=0;i<data.length;i++){							//Put the marker in the pins array							pins.push(createPin(data[i]));							bounds.extend(new google.maps.LatLng(parseFloat(data[i]['latitude']),parseFloat(data[i]['longitude'])));							}						if(!bounds.isEmpty()){							map.fitBounds(bounds);						}										}										function assignIcon(year){						switch(year){							case '2011':								return "img/red_dot.png";							break;							case '2012':								return "img/blue_dot.png";							break;							case '2013':								return "img/yellow_dot.png";							break;							case '2014':								return "img/white_dot.png";							break;						}					}										function createPin(row){						//Create the marker object from the attributes stored in the array member						var marker = new google.maps.Marker({							position: new google.maps.LatLng(parseFloat(row.latitude), parseFloat(row.longitude)),							map: map,							icon: assignIcon(row.year)						});													//Assign properties to the marker object						for(j in row){							marker[j] = row[j];						}												google.maps.event.addListener(marker, "click", function(){							/*var content = '<div id="map_bubble" class="borderbox">' +							'<div id="map_avatar" class="borderbox"><img src="' + row['pic'] + '"/></div>'+							'<div id="map_header" class="borderbox"><h4>' + row['name'] + '</h4></div>'+							'<div id="map_description" class="borderbox">' + row['description'] + '</div>'+							'</div>';*/														var content = '<div class="borderbox" id="map_bubble">' +							'<div class="borderbox" id="map_avatar"><img src="' + row['pic'] + '"/></div>'+							'<div class="borderbox" id="map_header"><h4>' + row['name'] + '</h4></div>'+							'<div class="borderbox" id="map_description">' + row['description'] + '</div>'+							'</div>';																					var myOptions = {								 content: content								,disableAutoPan: false								,maxWidth: 0								,pixelOffset: new google.maps.Size(-200, -210)								,zIndex: null								,boxStyle: { 								  opacity: 1								  ,height: "180px",								  width: "440px",								  background: "url('img/arrow.png') 190px 180px no-repeat",								  "z-index":"9999",								  "padding-bottom": "20px"								 }								,closeBoxMargin: "5px 5px 0px 0px"								,closeBoxURL: "img/close.png"								,infoBoxClearance: new google.maps.Size(1, 1)								,isHidden: false								,pane: "floatPane"								,enableEventPropagation: false							};							infobox.setOptions(myOptions);							infobox.open(map, marker);														/*infowindow.setOptions({								content: content							});													infowindow.open(map, marker);*/						});												return marker;									}										function filterdata(options){						//First, loop through all the markers in the pins array						var bounds = new google.maps.LatLngBounds();												for(i=0;i<pins.length;i++){							//then apply the filters passed with the options parameter														var filters = [								(options.years.length>0) ? 	(function(){ return (jQ.inArray(pins[i].year, options.years)>-1); })() : true,								(options.countries.length>0) ? 	(function(){ return (jQ.inArray(pins[i].country_region, options.countries)>-1); })() : true,								(options.areas.length>0) ? 	(function(){ return (jQ.inArray(pins[i].issue_area, options.areas)>-1); })() : true							];														var filterswitch = filters.every(function(value,index,ar){								if(value){									return true;								}								else								{									return false								}							});														if(filterswitch){								pins[i].setMap(map);								bounds.extend(pins[i].getPosition());							}							else							{								pins[i].setMap(null);							}						}												if(!bounds.isEmpty()){							map.fitBounds(bounds);							if(map.getZoom()>16){								map.setZoom(10);							}						}					}										return{						//Function to initialize the map						start: function(){							init();						},						centerMap: function(){							map.setCenter(center);						},						loadContacts: function(contacts){							//Contacts is a js array containing object literals representing each contact and its attributes							loaddata(contacts);						},						filterContacts: function(options){							//options should look something like {years: [], countries: [], areas: []}							//the value arrays would hold the actual filter parameters							filterdata(options);						},						preFilterContacts: function(){							var years = [];							var countries = [];							var areas = [];														jQ("input:checkbox.year").each(function(){								if(jQ(this).prop("checked")){									years.push(jQ(this).parent().parent().parent().find('label').html());								}							});							jQ("input:checkbox.country").each(function(){								if(jQ(this).prop("checked")){									countries.push(jQ(this).parent().parent().parent().find('label').html());								}							});														jQ("input:checkbox.issuearea").each(function(){								if(jQ(this).prop("checked")){									areas.push(jQ(this).parent().parent().parent().find('label').html());								}							});														filterdata({'years': years, 'countries': countries, 'areas': areas});						},						realignControls: function(width){							if(width<330){								jQ(".container").css("position", "");							}							else							{								jQ(".container").css("position", "absolute");							}						}					};				 				// Pull in jQuery				}) ($);							window.onload = function(){				contactMap.start();				contactMap.loadContacts(contacts);				//Left here for starting the map already filtered, just in case				//contactMap.filterContacts({years: [2010,2011,2012], countries: ['Norway', 'USA'], areas: ['B','C']});			};							window.onresize = function(){				contactMap.centerMap();				contactMap.realignControls(document.getElementById("map").offsetWidth);			}		</script>	</body></html>	